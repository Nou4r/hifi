<script lang="ts">
	import * as InputGroup from '$lib/components/ui/input-group/index.js';
	import CheckIcon from '@lucide/svelte/icons/check';
	import CopyIcon from '@lucide/svelte/icons/copy';
	import { UseClipboard } from '$lib/hooks/use-clipboard.svelte.js';
	import Label from './ui/label.svelte';
	import * as Password from '$lib/components/ui/password';

	const slug = (s: string) =>
		s
			.toLowerCase()
			.trim()
			.replace(/\s+/g, '-')
			.replace(/[^a-z0-9_-]/g, '');

	const baseFields = [
		{ label: 'Hostname', value: 'example.com' },
		{ label: 'Username', value: 'John' },
		{ label: 'Password', value: 'password123' }
	];

	const fields = baseFields.map((f, i) => ({
		...f,
		id: `field-${i}-${slug(f.label)}`
	}));

	const clipboards = fields.map(() => new UseClipboard());
	const isPassword = (label: string) => label.toLowerCase() === 'password';
</script>

<svelte:head>
	<style></style>
</svelte:head>

<div class="grid w-full max-w-sm gap-4">
	{#each fields as field, i}
		<div class="flex flex-col gap-2">
			<Label for={field.id} class="text-left text-sm text-zinc-400">{field.label}</Label>

			{#if isPassword(field.label)}
				<Password.Root>
					<Password.Input
						id={field.id}
						name={field.label}
						value={field.value}
						autocomplete="off"
						readonly
						class="border border-zinc-700 bg-zinc-900 text-zinc-300"
					>
						<Password.ToggleVisibility
							class="cursor-pointer hover:data-[state=off]:text-zinc-300 hover:data-[state=on]:text-zinc-300"
						/>
						<Password.Copy
							class="cursor-pointer hover:bg-zinc-700 hover:text-zinc-200"
							aria-label="Copy Password"
							title="Copy Password"
						/>
					</Password.Input>
				</Password.Root>
			{:else}
				<InputGroup.Root class="border border-zinc-700 bg-zinc-900">
					<InputGroup.Input
						id={field.id}
						name={field.label}
						value={field.value}
						autocomplete="off"
						readonly
						class="text-zinc-300"
					/>
					<InputGroup.Addon align="inline-end">
						<InputGroup.Button
							aria-label={`Copy ${field.label}`}
							title={`Copy ${field.label}`}
							size="icon-xs"
							autocomplete="current-password"
							class="cursor-pointer hover:bg-zinc-700 hover:text-white"
							onclick={() => clipboards[i].copy(field.value)}
						>
							{#if clipboards[i].copied}
								<CheckIcon />
							{:else}
								<CopyIcon />
							{/if}
						</InputGroup.Button>
					</InputGroup.Addon>
				</InputGroup.Root>
			{/if}
		</div>
	{/each}

	<div
		class="flex items-center py-2 text-sm text-zinc-400 before:me-6 before:flex-1 before:border-t before:border-zinc-600 after:ms-6 after:flex-1 after:border-t after:border-zinc-600 dark:text-white dark:before:border-neutral-600 dark:after:border-neutral-600"
	>
		Supported Apps
	</div>

	<a
		aria-label="Open Feishin on GitHub"
		href="https://github.com/jeffvli/feishin"
		class="text-sm text-zinc-400"
		target="_blank"
		rel="noopener noreferrer"
	>
		<svg
			version="1.1"
			xmlns="http://www.w3.org/2000/svg"
			width="32"
			height="32"
			viewBox="0 0 64 64"
			fill="none"
			role="img"
			class="bottom-10 left-1/2 -translate-x-1/2 hover:opacity-80"
		>
			<path
				d="M0 0 C5.74878489 4.38952773 10.86633901 11.51318808 12.05078125 18.75 C12.80065902 29.88752877 12.46271824 39.28401149 5.42578125 48.5 C-0.16912254 54.52308521 -7.32027455 58.43833819 -15.48828125 58.98828125 C-26.20542141 59.27952927 -35.14630209 58.2120695 -43.34765625 50.59375 C-51.3869265 41.33878523 -52.67841391 32.52227501 -52.12841797 20.69873047 C-51.44383799 13.25415642 -47.5350846 6.60212923 -41.94921875 1.75 C-29.18967617 -7.17360414 -13.43737558 -8.61715468 0 0 Z "
				fill="#EDEDED"
				transform="translate(51.94921875,5.25)"
			/>
			<path
				d="M0 0 C4.84344302 2.07644071 8.18316029 6.13758431 11.83569336 9.83886719 C13.29624031 11.31330554 14.77922234 12.76213424 16.265625 14.21044922 C17.65297852 15.60070312 17.65297852 15.60070312 19.06835938 17.01904297 C19.9163208 17.8662793 20.76428223 18.71351562 21.63793945 19.58642578 C23.72475457 22.38575141 23.91685441 23.65977371 23.48632812 27.06591797 C21.73632812 27.76123047 21.73632812 27.76123047 19.48632812 28.06591797 C17.48632812 26.80810547 17.48632812 26.80810547 15.48632812 24.94091797 C14.7928125 24.29638672 14.09929688 23.65185547 13.38476562 22.98779297 C11.23375048 20.81022208 9.3446324 18.49600818 7.48632812 16.06591797 C6.82632813 15.73591797 6.16632812 15.40591797 5.48632812 15.06591797 C4.78141546 12.74385272 4.11420384 10.40998729 3.48632812 8.06591797 C2.37465949 6.73404003 2.37465949 6.73404003 -0.45117188 6.87841797 C-3.62260046 6.73313063 -3.62260046 6.73313063 -5.51367188 9.06591797 C-5.61679687 9.99404297 -5.71992188 10.92216797 -5.82617188 11.87841797 C-6.72232323 16.03330153 -8.35811929 17.25336023 -11.51367188 20.06591797 C-12.68071823 21.31556349 -13.84736818 22.56557929 -15.01367188 23.81591797 C-17.24347646 26.0554597 -18.35100211 27.00933718 -21.38867188 28.06591797 C-22.08992188 28.06591797 -22.79117187 28.06591797 -23.51367188 28.06591797 C-24.51367188 27.06591797 -24.51367188 27.06591797 -24.8659668 24.83691406 C-24.36970648 20.9335498 -22.61963419 19.50966104 -19.87695312 16.72998047 C-19.4004985 16.24637054 -18.92404388 15.76276062 -18.43315125 15.26449585 C-17.42464733 14.24822384 -16.40972525 13.23828608 -15.38891602 12.234375 C-13.82921487 10.69392341 -12.30109394 9.12636005 -10.7734375 7.55419922 C-9.7888808 6.56935221 -8.80260747 5.58621771 -7.81445312 4.60498047 C-6.47120972 3.26234131 -6.47120972 3.26234131 -5.10083008 1.89257812 C-2.51367188 0.06591797 -2.51367188 0.06591797 0 0 Z "
				fill="#131313"
				transform="translate(32.513671875,17.93408203125)"
			/>
			<path
				d="M0 0 C1.875 1.125 1.875 1.125 3 3 C3.1875 6.1875 3.1875 6.1875 3 9 C3.99 9.33 4.98 9.66 6 10 C7.38671875 11.62890625 7.38671875 11.62890625 8.6875 13.5625 C9.12449219 14.20316406 9.56148437 14.84382813 10.01171875 15.50390625 C10.50091797 16.24447266 10.50091797 16.24447266 11 17 C10.236875 17.103125 9.47375 17.20625 8.6875 17.3125 C5.95645104 17.7598463 5.95645104 17.7598463 4.4375 19.625 C3.963125 20.07875 3.48875 20.5325 3 21 C0.8125 20.6875 0.8125 20.6875 -1 20 C-1 19.01 -1 18.02 -1 17 C-1.763125 17.33 -2.52625 17.66 -3.3125 18 C-6 19 -6 19 -9 19 C-11.1875 17 -11.1875 17 -13 15 C-15.31 17.31 -17.62 19.62 -20 22 C-20.99 21.67 -21.98 21.34 -23 21 C-22.46890625 20.55269531 -21.9378125 20.10539062 -21.390625 19.64453125 C-17.49526489 16.31072852 -14.18101204 13.03743836 -11 9 C-10.34 9 -9.68 9 -9 9 C-9.061875 8.071875 -9.12375 7.14375 -9.1875 6.1875 C-9 3 -9 3 -7.875 1.125 C-5.11909116 -0.52854531 -3.14924548 -0.39365568 0 0 Z "
				fill="#DADADA"
				transform="translate(35,24)"
			/>
			<path
				d="M0 0 C2.3515625 0.47265625 2.3515625 0.47265625 4.9765625 2.97265625 C5.6571875 4.21015625 5.6571875 4.21015625 6.3515625 5.47265625 C4.7015625 6.79265625 3.0515625 8.11265625 1.3515625 9.47265625 C0.6915625 8.81265625 0.0315625 8.15265625 -0.6484375 7.47265625 C-3.12110515 7.81710506 -3.12110515 7.81710506 -5.6484375 8.47265625 C-6.6384375 8.47265625 -7.6284375 8.47265625 -8.6484375 8.47265625 C-10.3359375 6.47265625 -10.3359375 6.47265625 -11.6484375 4.47265625 C-8.5043647 -0.10054055 -5.17625084 -0.17559553 0 0 Z "
				fill="#0B0B0B"
				transform="translate(34.6484375,34.52734375)"
			/>
			<path
				d="M0 0 C3.125 0.25 3.125 0.25 5 1.75 C5.37125 2.245 5.7425 2.74 6.125 3.25 C5.795 3.91 5.465 4.57 5.125 5.25 C3.805 4.59 2.485 3.93 1.125 3.25 C1.785 4.57 2.445 5.89 3.125 7.25 C1.145 8.24 1.145 8.24 -0.875 9.25 C-1.865 7.6 -2.855 5.95 -3.875 4.25 C-4.865 4.745 -4.865 4.745 -5.875 5.25 C-3.48114934 0.30270864 -3.48114934 0.30270864 0 0 Z "
				fill="#CBCBCB"
				transform="translate(31.875,23.75)"
			/>
			<path
				d="M0 0 C3.34998521 1.11666174 3.79340222 1.74694925 5.6875 4.5625 C6.34298828 5.52349609 6.34298828 5.52349609 7.01171875 6.50390625 C7.33785156 6.99761719 7.66398437 7.49132813 8 8 C6.8553125 8.1546875 6.8553125 8.1546875 5.6875 8.3125 C2.95645104 8.7598463 2.95645104 8.7598463 1.4375 10.625 C0.963125 11.07875 0.48875 11.5325 0 12 C-2.1875 11.6875 -2.1875 11.6875 -4 11 C-3.67 10.34 -3.34 9.68 -3 9 C-2.01 9 -1.02 9 0 9 C0.66 8.01 1.32 7.02 2 6 C1.01 4.68 0.02 3.36 -1 2 C-0.67 1.34 -0.34 0.68 0 0 Z "
				fill="#CFCFCF"
				transform="translate(38,33)"
			/>
			<path
				d="M0 0 C0.33 0.66 0.66 1.32 1 2 C1.66 2.33 2.32 2.66 3 3 C2.484375 3.37125 1.96875 3.7425 1.4375 4.125 C-1.24266238 6.18666337 -3.72333172 8.41540762 -6.21875 10.6953125 C-8.14998915 12.10986047 -9.66223375 12.57961221 -12 13 C-11.319375 12.34 -10.63875 11.68 -9.9375 11 C-6.43274653 7.50531766 -3.22778212 3.74869221 0 0 Z "
				fill="#CCCCCC"
				transform="translate(24,33)"
			/>
			<path
				d="M0 0 C0.33 0 0.66 0 1 0 C1.12375 0.969375 1.2475 1.93875 1.375 2.9375 C1.58125 3.948125 1.7875 4.95875 2 6 C2.66 6.33 3.32 6.66 4 7 C4 7.66 4 8.32 4 9 C1.69 8.67 -0.62 8.34 -3 8 C-1.125 1.125 -1.125 1.125 0 0 Z "
				fill="#E3E3E3"
				transform="translate(28,27)"
			/>
			<path
				d="M0 0 C1.32 0.66 2.64 1.32 4 2 C3.34 3.32 2.68 4.64 2 6 C0.68 5.34 -0.64 4.68 -2 4 C-1.34 2.68 -0.68 1.36 0 0 Z "
				fill="#1E1E1E"
				transform="translate(31,27)"
			/>
			<path
				d="M0 0 C0.66 1.32 1.32 2.64 2 4 C1.01 5.485 1.01 5.485 0 7 C-1.65 6.67 -3.3 6.34 -5 6 C-4.67 5.34 -4.34 4.68 -4 4 C-3.01 4 -2.02 4 -1 4 C-0.67 2.68 -0.34 1.36 0 0 Z "
				fill="#CECECE"
				transform="translate(56,41)"
			/>
		</svg>
	</a>
</div>
